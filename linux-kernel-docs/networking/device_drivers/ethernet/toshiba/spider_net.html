
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The Spidernet Device Driver &#8212; The Linux Kernel  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Linux Base Driver for WangXun(R) 10 Gigabit PCI Express Adapters" href="../wangxun/txgbe.html" />
    <link rel="prev" title="TLAN driver for Linux" href="../ti/tlan.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.3.0-rc7</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><!-- SPDX-License-Identifier: GPL-2.0 -->

<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../process/development-process.html">A guide to the Kernel Development Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../process/submitting-patches.html">Submitting patches: the essential guide to getting your code into the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../driver-api/index.html">Driver implementer’s API guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../subsystem-apis.html">Kernel subsystem documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../driver-api/index.html">Driver implementer’s API guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../locking/index.html">locking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../accounting/index.html">Accounting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../block/index.html">Block</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../cpu-freq/index.html">CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../fpga/index.html">fpga</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../isdn/index.html">ISDN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../leds/index.html">LEDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">Networking</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../af_xdp.html">AF_XDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../bareudp.html">Bare UDP Tunnelling Module Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../batman-adv.html">batman-adv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../can.html">SocketCAN - Controller Area Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../can_ucan_protocol.html">The UCAN Protocol</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">Hardware Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsa/index.html">Distributed Switch Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../devlink/index.html">Linux Devlink Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../caif/index.html">CAIF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ethtool-netlink.html">Netlink interface for ethtool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ieee802154.html">IEEE 802.15.4 Developer’s Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../j1939.html">J1939 Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kapi.html">Linux Networking and Network Devices APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../msg_zerocopy.html">MSG_ZEROCOPY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../failover.html">FAILOVER</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net_dim.html">Net DIM - Generic Network Dynamic Interrupt Moderation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net_failover.html">NET_FAILOVER</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../page_pool.html">Page Pool API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../phy.html">PHY Abstraction Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sfp-phylink.html">phylink</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../alias.html">IP-Aliasing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../bridge.html">Ethernet Bridging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../snmp_counter.html">SNMP counter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../checksum-offloads.html">Checksum Offloads</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../segmentation-offloads.html">Segmentation Offloads</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../scaling.html">Scaling in the Linux Networking Stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tls.html">Kernel TLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tls-offload.html">Kernel TLS offload</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nfc.html">Linux NFC subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../6lowpan.html">Netdev private dataroom for 6lowpan interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../6pack.html">6pack Protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../arcnet-hardware.html">ARCnet Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../arcnet.html">ARCnet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../atm.html">ATM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ax25.html">AX.25</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../bonding.html">Linux Ethernet Bonding Driver HOWTO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cdc_mbim.html">cdc_mbim - Driver for CDC MBIM Mobile Broadband modems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dccp.html">DCCP protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dctcp.html">DCTCP (DataCenter TCP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dns_resolver.html">DNS Resolver Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../driver.html">Softnet Driver Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../eql.html">EQL Driver: Serial IP Load Balancing HOWTO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fib_trie.html">LC-trie implementation notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../filter.html">Linux Socket Filtering aka Berkeley Packet Filter (BPF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generic-hdlc.html">Generic HDLC layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generic_netlink.html">Generic Netlink</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gen_stats.html">Generic networking statistics for netlink users</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gtp.html">The Linux kernel GTP tunneling module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ila.html">Identifier Locator Addressing (ILA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ioam6-sysctl.html">IOAM6 Sysfs variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ipddp.html">AppleTalk-IP Decapsulation and AppleTalk-IP Encapsulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ip_dynaddr.html">IP dynamic address hack-port v0.03</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ipsec.html">IPsec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ip-sysctl.html">IP Sysctl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ipv6.html">IPv6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ipvlan.html">IPVLAN Driver HOWTO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ipvs-sysctl.html">IPvs-sysctl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kcm.html">Kernel Connection Multiplexor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../l2tp.html">L2TP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lapb-module.html">The Linux LAPB Module Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../mac80211-injection.html">How to use packet injection with mac80211</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../mctp.html">Management Component Transport Protocol (MCTP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../mpls-sysctl.html">MPLS Sysfs variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../mptcp-sysctl.html">MPTCP Sysfs variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../multiqueue.html">HOWTO for multiqueue network device support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../netconsole.html">Netconsole</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../netdev-features.html">Netdev features mess and how to get out from it alive</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../netdevices.html">Network Devices, the Kernel, and You!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../netfilter-sysctl.html">Netfilter Sysfs variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../netif-msg.html">NETIF Msg Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nexthop-group-resilient.html">Resilient Next-hop Groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nf_conntrack-sysctl.html">Netfilter Conntrack Sysfs variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nf_flowtable.html">Netfilter’s flowtable infrastructure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../openvswitch.html">Open vSwitch datapath developer documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../operstates.html">Operational States</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../packet_mmap.html">Packet MMAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../phonet.html">Linux Phonet protocol family</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../pktgen.html">HOWTO for the linux packet generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../plip.html">PLIP: The Parallel Line Internet Protocol Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ppp_generic.html">PPP Generic Driver and Channel Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../proc_net_tcp.html">The proc/net/tcp and proc/net/tcp6 variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../radiotap-headers.html">How to use radiotap headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rds.html">RDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../regulatory.html">Linux wireless regulatory documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../representors.html">Network Function Representors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rxrpc.html">RxRPC Network Protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rxrpc.html#socket-options">SOCKET OPTIONS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rxrpc.html#security">SECURITY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rxrpc.html#example-client-usage">EXAMPLE CLIENT USAGE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sctp.html">Linux Kernel SCTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../secid.html">LSM/SeLinux secid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../seg6-sysctl.html">Seg6 Sysfs variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../skbuff.html">struct sk_buff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smc-sysctl.html">SMC Sysctl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../statistics.html">Interface statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../strparser.html">Stream Parser (strparser)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../switchdev.html">Ethernet switch device driver model (switchdev)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sysfs-tagging.html">Sysfs tagging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tc-actions-env-rules.html">TC Actions - Environmental Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tc-queue-filters.html">TC queue based filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tcp-thin.html">Thin-streams and TCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../team.html">Team</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timestamping.html">Timestamping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tipc.html">Linux Kernel TIPC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tproxy.html">Transparent proxy support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tuntap.html">Universal TUN/TAP device driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../udplite.html">The UDP-Lite protocol (RFC 3828)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vrf.html">Virtual Routing and Forwarding (VRF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vxlan.html">Virtual eXtensible Local Area Networking documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../x25-iface.html">Packet Layer to Device Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../x25-iface.html#device-driver-to-packet-layer">Device Driver to Packet Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../x25-iface.html#requirements-for-the-device-driver">Requirements for the device driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../x25.html">Linux X.25 Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xfrm_device.html">XFRM device - offloading the IPsec computations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xfrm_proc.html">XFRM proc - /proc/net/xfrm_* files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xfrm_sync.html">XFRM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xfrm_sysctl.html">XFRM Syscall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xdp-rx-metadata.html">XDP RX Metadata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../power/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../timers/index.html">timers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../watchdog/index.html">Watchdog Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../virt/index.html">Virtualization Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../input/index.html">Input Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hwmon/index.html">Hardware Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../gpu/index.html">GPU Driver Developer’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../accel/index.html">Compute Accelerators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../security/index.html">Security Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sound/index.html">Sound Subsystem Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../crypto/index.html">Crypto API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mm/index.html">Memory Management Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../usb/index.html">USB support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../PCI/index.html">PCI Bus Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../scsi/index.html">SCSI Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../scheduler/index.html">Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mhi/index.html">MHI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../peci/index.html">PECI Subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../locking/index.html">Locking in the kernel</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../process/license-rules.html">Linux kernel licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev-tools/testing-overview.html">Kernel Testing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../livepatch/index.html">Kernel Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../kbuild/index.html">The kernel build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tools/index.html">User-space tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../devicetree/index.html">Open Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../arch.html">CPU Architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../staging/index.html">Unsorted Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../translations/index.html">Translations</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  sbar.scrollTop = currents[currents.length - 1].offsetTop;
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/networking/device_drivers/ethernet/toshiba/spider_net.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="the-spidernet-device-driver">
<h1>The Spidernet Device Driver<a class="headerlink" href="#the-spidernet-device-driver" title="Permalink to this headline">¶</a></h1>
<p>Written by Linas Vepstas &lt;<a class="reference external" href="mailto:linas&#37;&#52;&#48;austin&#46;ibm&#46;com">linas<span>&#64;</span>austin<span>&#46;</span>ibm<span>&#46;</span>com</a>&gt;</p>
<p>Version of 7 June 2007</p>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This document sketches the structure of portions of the spidernet
device driver in the Linux kernel tree. The spidernet is a gigabit
ethernet device built into the Toshiba southbridge commonly used
in the SONY Playstation 3 and the IBM QS20 Cell blade.</p>
</section>
<section id="the-structure-of-the-rx-ring">
<h2>The Structure of the RX Ring.<a class="headerlink" href="#the-structure-of-the-rx-ring" title="Permalink to this headline">¶</a></h2>
<p>The receive (RX) ring is a circular linked list of RX descriptors,
together with three pointers into the ring that are used to manage its
contents.</p>
<p>The elements of the ring are called “descriptors” or “descrs”; they
describe the received data. This includes a pointer to a buffer
containing the received data, the buffer size, and various status bits.</p>
<p>There are three primary states that a descriptor can be in: “empty”,
“full” and “not-in-use”.  An “empty” or “ready” descriptor is ready
to receive data from the hardware. A “full” descriptor has data in it,
and is waiting to be emptied and processed by the OS. A “not-in-use”
descriptor is neither empty or full; it is simply not ready. It may
not even have a data buffer in it, or is otherwise unusable.</p>
<p>During normal operation, on device startup, the OS (specifically, the
spidernet device driver) allocates a set of RX descriptors and RX
buffers. These are all marked “empty”, ready to receive data. This
ring is handed off to the hardware, which sequentially fills in the
buffers, and marks them “full”. The OS follows up, taking the full
buffers, processing them, and re-marking them empty.</p>
<p>This filling and emptying is managed by three pointers, the “head”
and “tail” pointers, managed by the OS, and a hardware current
descriptor pointer (GDACTDPA). The GDACTDPA points at the descr
currently being filled. When this descr is filled, the hardware
marks it full, and advances the GDACTDPA by one.  Thus, when there is
flowing RX traffic, every descr behind it should be marked “full”,
and everything in front of it should be “empty”.  If the hardware
discovers that the current descr is not empty, it will signal an
interrupt, and halt processing.</p>
<p>The tail pointer tails or trails the hardware pointer. When the
hardware is ahead, the tail pointer will be pointing at a “full”
descr. The OS will process this descr, and then mark it “not-in-use”,
and advance the tail pointer.  Thus, when there is flowing RX traffic,
all of the descrs in front of the tail pointer should be “full”, and
all of those behind it should be “not-in-use”. When RX traffic is not
flowing, then the tail pointer can catch up to the hardware pointer.
The OS will then note that the current tail is “empty”, and halt
processing.</p>
<p>The head pointer (somewhat mis-named) follows after the tail pointer.
When traffic is flowing, then the head pointer will be pointing at
a “not-in-use” descr. The OS will perform various housekeeping duties
on this descr. This includes allocating a new data buffer and
dma-mapping it so as to make it visible to the hardware. The OS will
then mark the descr as “empty”, ready to receive data. Thus, when there
is flowing RX traffic, everything in front of the head pointer should
be “not-in-use”, and everything behind it should be “empty”. If no
RX traffic is flowing, then the head pointer can catch up to the tail
pointer, at which point the OS will notice that the head descr is
“empty”, and it will halt processing.</p>
<p>Thus, in an idle system, the GDACTDPA, tail and head pointers will
all be pointing at the same descr, which should be “empty”. All of the
other descrs in the ring should be “empty” as well.</p>
<p>The show_rx_chain() routine will print out the locations of the
GDACTDPA, tail and head pointers. It will also summarize the contents
of the ring, starting at the tail pointer, and listing the status
of the descrs that follow.</p>
<p>A typical example of the output, for a nearly idle system, might be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>net eth1: Total number of descrs=256
net eth1: Chain tail located at descr=20
net eth1: Chain head is at 20
net eth1: HW curr desc (GDACTDPA) is at 21
net eth1: Have 1 descrs with stat=x40800101
net eth1: HW next desc (GDACNEXTDA) is at 22
net eth1: Last 255 descrs with stat=xa0800000
</pre></div>
</div>
<p>In the above, the hardware has filled in one descr, number 20. Both
head and tail are pointing at 20, because it has not yet been emptied.
Meanwhile, hw is pointing at 21, which is free.</p>
<p>The “Have nnn decrs” refers to the descr starting at the tail: in this
case, nnn=1 descr, starting at descr 20. The “Last nnn descrs” refers
to all of the rest of the descrs, from the last status change. The “nnn”
is a count of how many descrs have exactly the same status.</p>
<p>The status x4… corresponds to “full” and status xa… corresponds
to “empty”. The actual value printed is RXCOMST_A.</p>
<p>In the device driver source code, a different set of names are
used for these same concepts, so that:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;empty&quot; == SPIDER_NET_DESCR_CARDOWNED == 0xa
&quot;full&quot;  == SPIDER_NET_DESCR_FRAME_END == 0x4
&quot;not in use&quot; == SPIDER_NET_DESCR_NOT_IN_USE == 0xf
</pre></div>
</div>
</section>
<section id="the-rx-ram-full-bug-feature">
<h2>The RX RAM full bug/feature<a class="headerlink" href="#the-rx-ram-full-bug-feature" title="Permalink to this headline">¶</a></h2>
<p>As long as the OS can empty out the RX buffers at a rate faster than
the hardware can fill them, there is no problem. If, for some reason,
the OS fails to empty the RX ring fast enough, the hardware GDACTDPA
pointer will catch up to the head, notice the not-empty condition,
ad stop. However, RX packets may still continue arriving on the wire.
The spidernet chip can save some limited number of these in local RAM.
When this local ram fills up, the spider chip will issue an interrupt
indicating this (GHIINT0STS will show ERRINT, and the GRMFLLINT bit
will be set in GHIINT1STS).  When the RX ram full condition occurs,
a certain bug/feature is triggered that has to be specially handled.
This section describes the special handling for this condition.</p>
<p>When the OS finally has a chance to run, it will empty out the RX ring.
In particular, it will clear the descriptor on which the hardware had
stopped. However, once the hardware has decided that a certain
descriptor is invalid, it will not restart at that descriptor; instead
it will restart at the next descr. This potentially will lead to a
deadlock condition, as the tail pointer will be pointing at this descr,
which, from the OS point of view, is empty; the OS will be waiting for
this descr to be filled. However, the hardware has skipped this descr,
and is filling the next descrs. Since the OS doesn’t see this, there
is a potential deadlock, with the OS waiting for one descr to fill,
while the hardware is waiting for a different set of descrs to become
empty.</p>
<p>A call to show_rx_chain() at this point indicates the nature of the
problem. A typical print when the network is hung shows the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>net eth1: Spider RX RAM full, incoming packets might be discarded!
net eth1: Total number of descrs=256
net eth1: Chain tail located at descr=255
net eth1: Chain head is at 255
net eth1: HW curr desc (GDACTDPA) is at 0
net eth1: Have 1 descrs with stat=xa0800000
net eth1: HW next desc (GDACNEXTDA) is at 1
net eth1: Have 127 descrs with stat=x40800101
net eth1: Have 1 descrs with stat=x40800001
net eth1: Have 126 descrs with stat=x40800101
net eth1: Last 1 descrs with stat=xa0800000
</pre></div>
</div>
<p>Both the tail and head pointers are pointing at descr 255, which is
marked xa… which is “empty”. Thus, from the OS point of view, there
is nothing to be done. In particular, there is the implicit assumption
that everything in front of the “empty” descr must surely also be empty,
as explained in the last section. The OS is waiting for descr 255 to
become non-empty, which, in this case, will never happen.</p>
<p>The HW pointer is at descr 0. This descr is marked 0x4.. or “full”.
Since its already full, the hardware can do nothing more, and thus has
halted processing. Notice that descrs 0 through 254 are all marked
“full”, while descr 254 and 255 are empty. (The “Last 1 descrs” is
descr 254, since tail was at 255.) Thus, the system is deadlocked,
and there can be no forward progress; the OS thinks there’s nothing
to do, and the hardware has nowhere to put incoming data.</p>
<p>This bug/feature is worked around with the spider_net_resync_head_ptr()
routine. When the driver receives RX interrupts, but an examination
of the RX chain seems to show it is empty, then it is probable that
the hardware has skipped a descr or two (sometimes dozens under heavy
network conditions). The spider_net_resync_head_ptr() subroutine will
search the ring for the next full descr, and the driver will resume
operations there.  Since this will leave “holes” in the ring, there
is also a spider_net_resync_tail_ptr() that will skip over such holes.</p>
<p>As of this writing, the spider_net_resync() strategy seems to work very
well, even under heavy network loads.</p>
</section>
<section id="the-tx-ring">
<h2>The TX ring<a class="headerlink" href="#the-tx-ring" title="Permalink to this headline">¶</a></h2>
<p>The TX ring uses a low-watermark interrupt scheme to make sure that
the TX queue is appropriately serviced for large packet sizes.</p>
<p>For packet sizes greater than about 1KBytes, the kernel can fill
the TX ring quicker than the device can drain it. Once the ring
is full, the netdev is stopped. When there is room in the ring,
the netdev needs to be reawakened, so that more TX packets are placed
in the ring. The hardware can empty the ring about four times per jiffy,
so its not appropriate to wait for the poll routine to refill, since
the poll routine runs only once per jiffy.  The low-watermark mechanism
marks a descr about 1/4th of the way from the bottom of the queue, so
that an interrupt is generated when the descr is processed. This
interrupt wakes up the netdev, which can then refill the queue.
For large packets, this mechanism generates a relatively small number
of interrupts, about 1K/sec. For smaller packets, this will drop to zero
interrupts, as the hardware can empty the queue faster than the kernel
can fill it.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../../_sources/networking/device_drivers/ethernet/toshiba/spider_net.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>